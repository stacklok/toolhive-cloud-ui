import type { RequestHandler } from "msw";
import { HttpResponse } from "msw";
import { autoGeneratedHandlers } from "./mocker";
import { mockScenario } from "./mockScenario";
import { serverDetailHandlers } from "./server-detail";

// Scenario handlers (activate via cookie: mock-scenario=<name>)
const scenarioHandlers = [
  mockScenario("empty-servers").get("*/registry/v0.1/servers", () => {
    return HttpResponse.json({ servers: [], metadata: { count: 0 } });
  }),
  mockScenario("server-error").get("*/registry/v0.1/servers", () => {
    return HttpResponse.json(
      { error: "Internal Server Error" },
      { status: 500 },
    );
  }),
];

export const handlers: RequestHandler[] = [
  // Scenario handlers must come first (MSW uses first match)
  ...scenarioHandlers,
  ...serverDetailHandlers,
  ...autoGeneratedHandlers,
];
